<mvc:View
	xmlns:core="sap.ui.core"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns="sap.m"
	xmlns:l="sap.ui.layout"
	xmlns:f="sap.f"
	xmlns:fb="sap.ui.comp.filterbar"
	controllerName="requisitions.requisitions.controller.order.List"
	xmlns:html="http://www.w3.org/1999/xhtml"
>
	<f:DynamicPage
		id="dynamicPageId"
		headerExpanded="true"
		toggleHeaderOnTitleClick="false"
		showFooter="true"
	>
		<!-- DynamicPage Title -->
		<f:title>
			<f:DynamicPageTitle>
				<f:heading>
					<Title
						text="{i18n>listOrderTitle}"
						wrapping="true"
					/>
				</f:heading>
				<f:actions>
					<Button
						text="{i18n>update}"
						type="Emphasized"
						press=".updateUserData"
						visible="true"
					/>
				</f:actions>
			</f:DynamicPageTitle>
		</f:title>
		<!-- DynamicPage Header -->
		<f:header>
			<f:DynamicPageHeader pinnable="true">
				<fb:FilterBar
					id="filterBar"
					search="onSearch"
					useToolbar="false"
					showGoOnFB="true"
				>
					<fb:filterGroupItems>
						<fb:FilterGroupItem
							name="Company"
							groupName="g1"
							mandatory="true"
							visibleInFilterBar="true"
							label="{i18n>company}"
						>
							<fb:control>
								<Select
									id="selectEmpresa"
									selectedKey="{oModelListOrder>/idEmpresa}"
									forceSelection="false"
									change="onCompanySelect"
									items="{ path: 'oModel>/Companies', sorter: { path: 'IdEmpresas' } }"
									busy="{oModel>/companySelectBusy}"
								>
									<core:Item
										key="{oModel>IdEmpresas}"
										text="{oModel>Empresas}"
									/>
								</Select>
							</fb:control>
						</fb:FilterGroupItem>
						<fb:FilterGroupItem
							name="Country"
							groupName="g1"
							visibleInFilterBar="true"
							label="{i18n>country}"
						>
							<fb:control>
								<Input
									id="country"
									editable="false"
									value="{oModel>/Country}"
								/>
							</fb:control>
						</fb:FilterGroupItem>
						<fb:FilterGroupItem
							name="CompanyBranch"
							groupName="g1"
							visibleInFilterBar="true"
							label="{i18n>branch}"
						>
							<fb:control>
								<Select
									id="filial"
									forceSelection="false"
									change="onBranchSelect"
									selectedKey="{oModelListOrder>/branchFilter}"
									enabled="{oModelListOrder>/Enabled}"
									items="{ path: 'oModel>/Branches', sorter: { path: 'idFilial' } }"
								>
									<core:Item
										key="{oModel>idFilial}"
										text="{oModel>nomeFilial}"
									/>
								</Select>
							</fb:control>
						</fb:FilterGroupItem>
						<fb:FilterGroupItem
							groupName="G1"
							name="C"
							label="{i18n>orderNum}"
							partOfCurrentVariant="true"
							visibleInFilterBar="true"
						>
							<fb:control>
								<MultiInput
									id="numeroRequisicaoMain"
									class="sapUiSmallMarginBottom"
									type="Text"
									placeholder=""
									showSuggestion="true"
									showValueHelp="true"
									valueHelpRequest="onOrderNumHelpRequest"
									valueHelpOnly="true"
									enabled="{oModelListOrder>/Enabled}"
									tokens="{ path: 'oModelListOrder>/ordNumTokens'}"
								>
									<tokens>
										<Token
											key="{oModelListOrder>key}"
											text="{oModelListOrder>text}"
											delete="deleteToken"
										/>
									</tokens>
								</MultiInput>
							</fb:control>
						</fb:FilterGroupItem>

						<fb:FilterGroupItem
							groupName="G1"
							name="D"
							label="{i18n>vendor}"
							partOfCurrentVariant="true"
							visibleInFilterBar="true"
						>
							<fb:control>
								<MultiInput
									id="vendorMain"
									class="sapUiSmallMarginBottom"
									type="Text"
									placeholder=""
									showSuggestion="true"
									showValueHelp="true"
									valueHelpRequest="onProviderMainHelpRequest"
									valueHelpOnly="true"
									enabled="{oModelListOrder>/Enabled}"
									tokens="{ path: 'oModelListOrder>/partnerTokens'}"
								>
									<tokens>
										<Token
											key="{oModelListOrder>key}"
											text="{oModelListOrder>text}"
											delete="deleteToken"
										/>
									</tokens>
								</MultiInput>
							</fb:control>
						</fb:FilterGroupItem>
						<fb:FilterGroupItem
							groupName="G1"
							name="F"
							label="{i18n>requesterUser}"
							partOfCurrentVariant="true"
							visibleInFilterBar="true"
						>
							<fb:control>
								<MultiInput
									id="solicitanteUsuarioMain"
									class="sapUiSmallMarginBottom"
									type="Text"
									placeholder=""
									showSuggestion="true"
									showValueHelp="true"
									valueHelpRequest="onUserMultiHelpRequest"
									valueHelpOnly="true"
									enabled="{oModelListOrder>/Enabled}"
									tokens="{ path: 'oModelListOrder>/userTokens'}"
								>
									<tokens>
										<Token
											key="{oModelListOrder>key}"
											text="{oModelListOrder>text}"
											delete="deleteToken"
										/>
									</tokens>
								</MultiInput>
							</fb:control>
						</fb:FilterGroupItem>
						<fb:FilterGroupItem
							groupName="G1"
							name="G"
							label="{i18n>requesterEmployee}"
							partOfCurrentVariant="true"
							visibleInFilterBar="true"
						>
							<fb:control>
								<MultiInput
									id="solicitanteColMain"
									class="sapUiSmallMarginBottom"
									type="Text"
									placeholder=""
									showSuggestion="true"
									showValueHelp="true"
									valueHelpRequest="onEmployeeMultiHelpRequest"
									valueHelpOnly="true"
									enabled="{oModelListOrder>/Enabled}"
									tokens="{ path: 'oModelListOrder>/employeeTokens'}"
								>
									<tokens>
										<Token
											key="{oModelListOrder>key}"
											text="{oModelListOrder>text}"
											delete="deleteToken"
										/>
									</tokens>
								</MultiInput>
							</fb:control>
						</fb:FilterGroupItem>
						<fb:FilterGroupItem
							groupName="G1"
							name="H"
							label="{i18n>approvalStatus}"
							partOfCurrentVariant="true"
							visibleInFilterBar="true"
						>
							<fb:control>
								<Select
									id="statusAprovMain"
									forceSelection="false"
									change="onApprovSelect"
									enabled="{oModelListOrder>/Enabled}"
									items="{ path: 'oModelListOrder>/approvalType'}"
									selectedKey="{oModelListOrder>/approvalStatusFilter}"
								>
									<core:Item
										key="{oModelListOrder>status}"
										text="{oModelListOrder>status}"
									/>
								</Select>
							</fb:control>
						</fb:FilterGroupItem>
						<fb:FilterGroupItem
							groupName="G1"
							name="I"
							label="{i18n>myApproval}"
							partOfCurrentVariant="true"
							visibleInFilterBar="{oModelListOrder>/approvalDivisionVisible}"
						>
							<fb:control>
								<Select
									id="minhaAprovMain"
									forceSelection="false"
									change="onMyApprovSelect"
									enabled="{oModelListOrder>/Enabled}"
									items="{ path: 'oModelListOrder>/approvalType'}"
									selectedKey="{oModelListOrder>/myApprovalStatusFilter}"
								>
									<core:Item
										key="{oModelListOrder>status}"
										text="{oModelListOrder>status}"
									/>
								</Select>
							</fb:control>
						</fb:FilterGroupItem>
						<fb:FilterGroupItem
							groupName="G1"
							name="J"
							label="{i18n>deliveryDate}"
							partOfCurrentVariant="true"
							visibleInFilterBar="true"
						>
							<fb:control>
								<DateRangeSelection
									id="datasNecessidade"
									valueFormat="yyyy-MM-dd"
									enabled="{oModelListOrder>/Enabled}"
									value="{oModelListOrder>/requiredDate}"
									dateValue="{oModelListOrder>/firstRequiredDate}"
									secondDateValue="{oModelListOrder>/secondRequiredDate}"
								/>
							</fb:control>
						</fb:FilterGroupItem>
					</fb:filterGroupItems>
				</fb:FilterBar>
			</f:DynamicPageHeader>
		</f:header>
		<f:content>
			<Table
				id="orderTable"
				width="100%"
				items="{oModelListOrder>/orderItems}"
				busy="{oModelListOrder>/orderItemsBusy}"
				mode="MultiSelect"
			>
				<headerToolbar>
					<OverflowToolbar>
						<Title
							text="{i18n>title_orders}"
							busyIndicatorSize="Auto"
							level="H2"
						/>
						<ToolbarSpacer/>
						<Button
							class="Aprovar"
							id="approveButton"
							icon="sap-icon://accept"
							text="{i18n>approve}"
							type="Transparent"
							press=".onApproveItemPress"
							visible="{oModelListOrder>/approvalDivisionVisible}"
						/>
						<Button
							class="Rejeitar"
							id="rejectButton"
							icon="sap-icon://decline"
							text="{i18n>reject}"
							type="Transparent"
							press=".onRejectItemPress"
							visible="{oModelListOrder>/approvalDivisionVisible}"
						/>
						<Button
							id="TablePrevious"
							icon="sap-icon://arrow-left"
							press="listPreviousButtonPress"
							type="Emphasized"
							enabled="{oModelListOrder>/previousTableButtonEnabled}"
						/>
						<Button
							id="TableNext"
							icon="sap-icon://arrow-right"
							press="listNextButtonPress"
							type="Emphasized"
							enabled="{oModelListOrder>/nextTableButtonEnabled}"
						/>
					</OverflowToolbar>
				</headerToolbar>
				<columns>
					<Column width="8rem">
						<Label text="{i18n>branch}"/>
					</Column>
					<Column
						width="8rem"
						hAlign="Center"
					>
						<Label text="{i18n>orderNumRedux}"/>
					</Column>
					<Column
						width="8rem"
						hAlign="Center"
					>
						<Label text="{i18n>approvalStatusRedux}"/>
					</Column>
					<Column
						width="8rem"
						hAlign="Center"
					>
						<Label text="{i18n>approvalSituation}"/>
					</Column>
					<Column
						width="8rem"
						hAlign="Center"
						visible="{oModelListOrder>/approvalDivisionVisible}"
					>
						<Label text="{i18n>myApprovalRedux}"/>
					</Column>
					<Column
						width="8rem"
						hAlign="Center"
					>
						<Label text="{i18n>canceled}"/>
					</Column>
					<Column
						width="8rem"
						hAlign="Center"
					>
						<Label text="{i18n>vendor}"/>
					</Column>
					<Column
						width="8rem"
						hAlign="Center"
					>
						<Label text="{i18n>deliveryDate}"/>
					</Column>
					<Column
						width="2rem"
						hAlign="Center"
					>
						<Label text=""/>
					</Column>
				</columns>
				<items>
					<!-- A cor da tabela tem como base o status de aprovaçao -->
					<ColumnListItem
						selected="{oModelListOrder>SelectedItem}"
						highlight="{path: 'oModelListOrder>U_Resu_work', formatter: '.formatter.approvalStatusHighlightFormatter'}"
					>
						<cells>
							<!-- Filial -->
							<Label text="{path: 'oModelListOrder>U_Filial', formatter: '.formatter.branchFormatter'}"/>
							<!-- número do pedido -->
							<Label text="{oModelListOrder>DocEntryDocumento}"/>
							<!-- Status Aprovaçao -->
							<ObjectStatus
								text="{path: 'oModelListOrder>U_Resu_work', formatter: '.formatter.approvalStatusTextFormatter'}"
								state="{path: 'oModelListOrder>U_Resu_work', formatter: '.formatter.approvalStatusStateFormatter'}"
							/>
							<!-- Situação aprovacao -->
							<ObjectStatus
								text="{oModelListOrder>U_Num_Aprov} / {oModelListOrder>U_Total_Aprov}"
								state="{path: 'oModelListOrder>U_Resu_work_indi', formatter: '.formatter.approvalStatusStateFormatter'}"
							/>
							<!-- Minha aprovaçao -->
							<ObjectStatus
								text="{path: 'oModelListOrder>U_Resu_work_indi', formatter: '.formatter.approvalStatusTextFormatter'}"
								state="{path: 'oModelListOrder>U_Resu_work_indi', formatter: '.formatter.approvalStatusStateFormatter'}"
							/>
							<!-- Cancelado -->
							<ObjectStatus
								text="{path: 'oModelListOrder>CANCELED', formatter: '.formatter.canceledFormatter'}"
								state="{path: 'oModelListOrder>CANCELED', formatter: '.formatter.canceledColorFormatter'}"
							/>
							<!-- Fornecedor -->
							<Label text="{oModelListOrder>U_Fornecedor}"/>
							<!--  Data de Entrega-->
							<Label text="{path: 'oModelListOrder>U_Data_Nec'}"/>
							<Button
								width="2rem"
								icon="sap-icon://feeder-arrow"
								type="Transparent"
								press="navToOrderDetail"
							>
							</Button>
						</cells>
					</ColumnListItem>
				</items>
			</Table>
		</f:content>
	</f:DynamicPage>
</mvc:View>