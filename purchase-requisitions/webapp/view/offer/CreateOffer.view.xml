<mvc:View
	controllerName="requisitions.requisitions.controller.offer.createOffer"
	xmlns:core="sap.ui.core"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns="sap.uxap"
	xmlns:m="sap.m"
	
	xmlns:html="http://www.w3.org/1999/xhtml"
	xmlns:layout="sap.ui.layout"
	xmlns:ui="sap.ui.table"
>
	<ObjectPageLayout
		id="createOfferViewID"
		showFooter="true"
		upperCaseAnchorBar="false"
	>
		<headerTitle>
			<ObjectPageDynamicHeaderTitle>
				<expandedHeading>
					<m:Title
						text="{oModelCreateOffer>/ViewTitle}"
						wrapping="true"
					/>
				</expandedHeading>
				<snappedHeading>
					<m:Title
						text="{i18n>newOffer}"
						wrapping="true"
					/>
				</snappedHeading>
				<expandedContent>
					<m:Text text="{ path: 'oModel>/currentDate', type: 'sap.ui.model.type.Date', formatOptions: { pattern: 'dd/MM/yyyy - HH:mm:ss' } }"/>
				</expandedContent>
				<snappedContent>
					<m:Text text="{ path: 'oModel>/currentDate', type: 'sap.ui.model.type.Date', formatOptions: { pattern: 'dd/MM/yyyy - HH:mm:ss' } }"/>
				</snappedContent>
				<actions>
					<m:Button
						text="{i18n>updateUserInfo}"
						type="Emphasized"
						press=".updateUserData"
					/>
					<m:Button
						text="{i18n>cancel}"
						type="Default"
						press=".onPressCancelCreateOffer"
					/>
				</actions>
			</ObjectPageDynamicHeaderTitle>
		</headerTitle>
		<sections>
			<ObjectPageSection
				titleUppercase="false"
				title="{i18n>generalInformation}"
			>
				<subSections>
					<ObjectPageSubSection
						titleUppercase="false"
						title="{i18n>generalInformation}"
						mode="Expanded"
					>
						<blocks>
							<layout:HorizontalLayout allowWrapping="true">
								<layout:VerticalLayout class="sapUiMediumMarginEnd">
									<m:Label
										text="{i18n>company}"
										labelFor="selectEmpresa"
										required="true"
									/>
									<m:Select
										id="selectEmpresa"
										width="20rem"
										selectedKey="{oModelCreateOffer>/companySelectedKey}"
										valueState="{oModelCreateOffer>/companySelectedKeyState}"
										forceSelection="false"
										change="onCompanySelect"
										items="{ path: 'oModel>/Companies', sorter: { path: 'IdEmpresas' } }"
										busy="{oModelCreateOffer>/companySelectBusy}"
									>
										<core:Item
											key="{oModel>IdEmpresas}"
											text="{oModel>Empresas}"
										/>
									</m:Select>
									<m:Label
										text="{i18n>branch}"
										labelFor="filial"
										required="true"
									/>
									<m:Select
										id="filial"
										width="20rem"
										forceSelection="false"
										change="onBranchSelect"
										selectedKey="{oModelCreateOffer>/branch}"
										editable="{oModelCreateOffer>/Editable}"
										items="{ path: 'oModel>/Branches', sorter: { path: 'idFilial' } }"
									>
										<core:Item
											key="{oModel>idFilial}"
											text="{oModel>nomeFilial}"
										/>
									</m:Select>
									<m:Label
										text="{i18n>copyRequisition}"
										labelFor="selectEmpresa"
									/>
									<m:Input
										id="copiarRequisicao"
										width="20rem"
										type="Text"
										showSuggestion="true"
										showValueHelp="true"
										valueHelpRequest="onCopyRequisitionHelpRequest"
										change="onCopyRequisitionSetManual"
										enabled="{oModelCreateOffer>/Editable}"
									/>
									<m:Label
										text="{i18n>requester}"
										labelFor="solicitante"
									/>
									<layout:VerticalLayout>
										<m:Select
											id="solicitante"
											width="20rem"
											busy="{oModelCreateOffer>/RequestTypeBusy}"
											forceSelection="false"
											change="onRequesterSelect"
											enabled="{oModelCreateOffer>/Editable}"
											items="{ path: 'oModelCreateOffer>/RequestType', sorter: { path: 'Type' } }"
											selectedKey="{oModelCreateOffer>/SelectedRequester}"
										>
											<core:Item
												key="{oModelCreateOffer>Type}"
												text="{oModelCreateOffer>Type}"
											/>
										</m:Select>
										<m:Input
											id="solicitanteColaborador"
											width="20rem"
											type="Text"
											showSuggestion="true"
											showValueHelp="true"
											valueHelpRequest="onEmployeeHelpRequest('colaborador')"
											change="onEmployeeValueSetManual"
											visible="{oModelCreateOffer>/solicitanteColaboradorVisible}"
											value="{oModelCreateOffer>/solicitanteColaboradorValue}"
											busy="{oModelCreateOffer>/solicitanteColaboradorBusy}"
										/>
										<m:Input
											id="solicitanteUsuario"
											width="20rem"
											type="Text"
											showSuggestion="true"
											showValueHelp="true"
											valueHelpRequest="onUserHelpRequest"
											change="onUserValueSetManual"
											visible="{oModelCreateOffer>/solicitanteUsuarioVisible}"
											value="{oModelCreateOffer>/solicitanteUsuarioValue}"
											busy="{oModelCreateOffer>/solicitanteUsuarioBusy}"
										/>
									</layout:VerticalLayout>
									<m:Label
										text="{i18n>department}"
										labelFor="departamento"
									/>
									<m:Select
										id="departamento"
										width="20rem"
										busy="{oModelCreateOffer>/DepartmentsBusy}"
										forceSelection="false"
										change="onDepartmentSelect"
										enabled="{oModelCreateOffer>/Editable}"
										items="{ path: 'oModelCreateOffer>/Departments' }"
										selectedKey="{oModelCreateOffer>/department}"
									>
										<core:Item
											key="{oModelCreateOffer>Code}"
											text="{oModelCreateOffer>Name}"
										/>
									</m:Select>
								</layout:VerticalLayout>
							</layout:HorizontalLayout>
							<layout:HorizontalLayout allowWrapping="true">
								<layout:VerticalLayout class="sapUiMediumMarginEnd">
									<m:Label
										text="{i18n>releaseDate}"
										labelFor="dataLancamento"
									/>
									<m:DatePicker
										id="dataLancamento"
										width="20rem"
										valueFormat="yyyy-MM-dd"
										value="{oModelCreateOffer>/releaseDate}"
										enabled="{oModelCreateOffer>/Editable}"
									/>
								</layout:VerticalLayout>
								<layout:VerticalLayout class="sapUiMediumMarginEnd">
									<m:Label
										text="{i18n>validUntil}"
										labelFor="validoAte"
									/>
									<m:DatePicker
										id="validoAte"
										width="20rem"
										valueFormat="yyyy-MM-dd"
										value="{oModelCreateOffer>/validUntil}"
										enabled="{oModelCreateOffer>/Editable}"
									/>
								</layout:VerticalLayout>
								<layout:VerticalLayout class="sapUiMediumMarginEnd">
									<m:Label
										text="{i18n>documentDate}"
										labelFor="dataDocumento"
									/>
									<m:DatePicker
										id="dataDocumento"
										width="20rem"
										valueFormat="yyyy-MM-dd"
										change="onDocDateSet"
										value="{oModelCreateOffer>/documentDate}"
										enabled="{oModelCreateOffer>/Editable}"
									/>
								</layout:VerticalLayout>
								<layout:VerticalLayout class="sapUiMediumMarginEnd">
									<m:Label
										text="{i18n>requiredDate}"
										labelFor="dataNecessaria"
										required="true"
									/>
									<m:DatePicker
										id="dataNecessaria"
										width="20rem"
										valueFormat="yyyy-MM-dd"
										value="{oModelCreateOffer>/requiredDate}"
										enabled="{oModelCreateOffer>/Editable}"
									/>
								</layout:VerticalLayout>
							</layout:HorizontalLayout>
						</blocks>
					</ObjectPageSubSection>
				</subSections>
			</ObjectPageSection>
			<ObjectPageSection
				titleUppercase="false"
				title="{i18n>itemTitle}"
			>
				<subSections>
					<ObjectPageSubSection titleUppercase="false">
						<blocks>
							<m:VBox>
								<m:Table
									showNoData="false"
									width="auto"
								>
									<m:headerToolbar>
										<m:OverflowToolbar>
											<m:content>
												<m:Title
													id="title2"
													text="{i18n>tableTitleItems}"
													class="Title"
												/>
												<m:ToolbarSpacer/>
												<m:Button
													id="copyButton"
													text="{i18n>copy}"
													type="Default"
													press=".onCopyItem"
													enabled="{oModelCreateOffer>/Editable}"
												/>
												<m:Button
													id="deleteButton"
													text="{i18n>remove}"
													type="Default"
													press=".onRemoveItem"
													enabled="{oModelCreateOffer>/Editable}"
												/>
												<!-- Botao de add -->
												<m:Button
													id="addButton"
													icon="sap-icon://add"
													type="Default"
													press=".onAddItem"
													enabled="{oModelCreateOffer>/Editable}"
												/>
											</m:content>
										</m:OverflowToolbar>
									</m:headerToolbar>
								</m:Table>
								<m:ScrollContainer
									height="100%"
									width="100%"
									vertical="true"
									focusable="true"
								>
									<ui:Table
										id="table"
										width="auto"
										rows="{oModelCreateOffer>/rows}"
										visibleRowCount="{oModelCreateOffer>/rowsCount}"
										busy="{oModelCreateOffer>/busyTable}"
										editable="{oModelCreateOffer>/Editable}"
									>
										<ui:columns>
											<ui:Column>
												<m:Label text="{i18n>itemId}"/>
												<ui:template>
													<m:Label
														text="{oModelCreateOffer>itemId}"
														wrapping="false"
													/>
												</ui:template>
											</ui:Column>
											<ui:Column>
												<m:Label
													text="{i18n>itemCode}"
													
												/>
												<ui:template>
													<m:Input
														showValueHelp="true"
														type="Text"
														showSuggestion="true"
														editable="{oModelCreateOffer>/Editable}"
														valueHelpRequest="onItemNumberHelpRequest"
														change="onItemNumberValueSetManual"
														value="{oModelCreateOffer>itemNumber}"
														busy="{oModelCreateOffer>itemNumberBusy}"
														valueState="{oModelCreateOffer>itemNumberState}"
													/>
												</ui:template>
											</ui:Column>
											<ui:Column>
												<m:Label text="{i18n>itemDescription}"/>
												<ui:template>
													<m:Input
														type="Text"
														editable="false"
														value="{oModelCreateOffer>itemNumberDesc}"
														busy="{oModelCreateOffer>itemNumberBusy}"
													/>
												</ui:template>
											</ui:Column>
											<ui:Column>
												<m:Label text="{i18n>qtProvider}"/>
												<ui:template>
													<m:Input
														showValueHelp="true"
														type="Text"
														showSuggestion="true"
														editable="false"
														valueHelpRequest="onCategoryHelpRequest"
														change="onCategoryValueSetManual"
														value="{oModelCreateOffer>ItemsProviderAddItemDialog}"
														busy="{oModelCreateOffer>ItemsProviderAddItemDialogBusy}"
													/>
												</ui:template>
											</ui:Column>
											<ui:Column>
												<m:Label
													text="{i18n>requiredDate}"
													
												/>
												<ui:template>
													<m:DatePicker
														valueFormat="yyyy-MM-dd"
														value="{oModelCreateOffer>/requiredDateRow}"
														valueState="{oModelCreateOffer>necessaryAmountState}"
														/>
												</ui:template>
											</ui:Column>
											<ui:Column>
												<m:Label
													text="{i18n>necessaryAmount}"
												/>
												<ui:template>
													<m:Input
														liveChange="necessaryAmountChange"
														valueState="{oModelCreateOffer>necessaryAmountState}"
														value="{oModelCreateOffer>necessaryAmount}"
														editable="{oModelCreateOffer>/Editable}"
													/>
												</ui:template>
											</ui:Column>
										</ui:columns>
									</ui:Table>
								</m:ScrollContainer>
								<layout:HorizontalLayout allowWrapping="true">
									<layout:VerticalLayout class="sapUiMediumMarginEnd">
										<m:FlexBox
											direction="Column"
											alignItems="Start"
										>
											<m:Label
												text="{i18n>holder}"
												labelFor="titular"
											/>
											<m:Input
												id="titular"
												width="20rem"
												type="Text"
												showSuggestion="true"
												showValueHelp="true"
												valueHelpRequest="onEmployeeHelpRequest('titular')"
												change="onTitularValueSetManual"
												value="{oModelCreateOffer>/documentsOwnerName}"
												busy="{oModelCreateOffer>/documentsOwnerNameBusy}"
												enabled="{oModelCreateOffer>/Enabled}"
												editable="{oModelCreateOffer>/Editable}"
											/>
											<m:Label
												text="{i18n>comments}"
												labelFor="observacoes"
											/>
											<m:TextArea
												id="observacoes"
												growing="true"
												value="{oModelCreateOffer>/comments}"
												showExceededText="true"
												maxLength="254"
												liveChange="handleLiveChange"
												valueLiveUpdate="true"
												width="40rem"
												rows="4"
												enabled="{oModelCreateOffer>/Enabled}"
												editable="{oModelCreateOffer>/Editable}"
											/>
										</m:FlexBox>
									</layout:VerticalLayout>
								</layout:HorizontalLayout>
							</m:VBox>
						</blocks>
					</ObjectPageSubSection>
				</subSections>
			</ObjectPageSection>
			<ObjectPageSection
				titleUppercase="false"
				title="{i18n>providers}"
			>
				<subSections>
					<ObjectPageSubSection
						title="{i18n>providers}"
						titleUppercase="false"
						mode="Expanded"
					>
						<blocks id="providersBlock">
							<m:Table
								id="table3"
								width="auto"
								items="{ path: 'oModelCreateOffer>/providerItens'}"
								noDataText="{i18n>noDataText}"
								mode="None"
							>
								<m:headerToolbar>
									<m:OverflowToolbar>
										<m:content>
											<m:Title
												id="title3"
												text="{i18n>tableTitleProvider}"
												class="Title"
											/>
										</m:content>
									</m:OverflowToolbar>
								</m:headerToolbar>
								<m:columns>
									<m:Column>
										<m:Text
											text="{i18n>provider}"
											wrapping="false"
										/>
									</m:Column>
									<m:Column>
										<m:Label text="{i18n>providerName}"/>
									</m:Column>
								</m:columns>
								<m:items>
									<m:ColumnListItem>
										<m:cells>
											<m:Text
												text="{oModelCreateOffer>CardCode}"
												wrapping="false"
											/>
											<m:Text
												text="{oModelCreateOffer>CardName}"
												wrapping="false"
											/>
										</m:cells>
									</m:ColumnListItem>
								</m:items>
							</m:Table>
						</blocks>
					</ObjectPageSubSection>
				</subSections>
			</ObjectPageSection>
			<ObjectPageSection
				titleUppercase="false"
				title="{i18n>attachments}"
			>
				<subSections>
					<ObjectPageSubSection
						title="Anexos"
						titleUppercase="false"
						mode="Expanded"
					>
						<blocks>
							<m:UploadCollection
								id="UploadCollection"
								items="{ path: 'oModelCreateOffer>/Anexos', templateShareable: false }"
								busy="{oModelCreateOffer>/AnexosBusy}"
								maximumFilenameLength="100"
								maximumFileSize="2"
								multiple="true"
								change="onChangeUploadCollection"
								fileDeleted="onFileDeleted"
								uploadComplete="onFileUploadComplete"
								filenameLengthExceed="onFilenameLengthExceed"
								selectionChange="onDownloadItem"
								fileSizeExceed="onFileSizeExceed"
								typeMissmatch="onFileTypeMissmatch"
								beforeUploadStarts="onBeforeUploadStarts"
								mode="SingleSelectMaster"
								uploadEnabled="{oModelCreateOffer>/Editable}"
							>
								<m:toolbar>
									<m:OverflowToolbar id="myId">
										<m:Title id="attachmentTitle"/>
										<m:ToolbarSpacer/>
										<m:UploadCollectionToolbarPlaceholder/>
									</m:OverflowToolbar>
								</m:toolbar>
								<m:items>
									<m:UploadCollectionItem
										id="fileItemId"
										documentId="{oModelCreateOffer>fileName}"
										fileName="{oModelCreateOffer>fileName}"
										mimeType="{oModelCreateOffer>Filemimetype}"
										enableEdit="false"
										visibleEdit="false"
										enableDelete="{oModelCreateOffer>/Editable}"
										visibleDelete="true"
										selected="{oModelCreateOffer>fileSelected}"
									/>
								</m:items>
							</m:UploadCollection>
						</blocks>
					</ObjectPageSubSection>
				</subSections>
			</ObjectPageSection>
		</sections>
		<footer>
			<m:OverflowToolbar>
				<m:ToolbarSpacer/>
				<m:Button
					type="Emphasized"
					text="{i18n>next}"
					press="onPressNextPage"
					enabled="{oModelCreateOffer>/nextEnabled}"
				/>
			</m:OverflowToolbar>
		</footer>
	</ObjectPageLayout>
</mvc:View>